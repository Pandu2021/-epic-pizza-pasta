############################################################
# cPanel Node.js (Passenger) .htaccess template for backend #
############################################################
# Place this .htaccess in your Application Root directory in cPanel.
# cPanel usually generates a .htaccess automatically; you can either
# merge the Passenger lines below into it or set the Startup File in UI.

# If you know your absolute app path, you can set PassengerAppRoot.
# Otherwise, you can omit this and rely on cPanel's generated config.
# Example (adjust path!):
# PassengerAppRoot /home/USERNAME/nodejs/APPLICATION_ROOT

PassengerAppType node
PassengerStartupFile deploy/cpanel/app.js

# Enforce HTTPS
RewriteEngine On
RewriteCond %{HTTPS} !=on
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Forward proto/IP headers so app can trust proxy
SetEnvIf X-Forwarded-Proto "https" HTTPS=on
RequestHeader set X-Forwarded-Proto "https" env=HTTPS
RequestHeader set X-Forwarded-For "%{REMOTE_ADDR}s" env=HTTPS

# Allow app to handle all non-existent paths (API routes)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ - [L]

